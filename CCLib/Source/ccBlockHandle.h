#ifndef _CCBLOCKHANDLE_H_
#define _CCBLOCKHANDLE_H_

/*==============================================================================
==============================================================================*/

//******************************************************************************
//******************************************************************************
//******************************************************************************
namespace CC
{

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Memory handle.

struct BlockHandle
{
   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   //---------------------------------------------------------------------------
   // Memory pool index, specifies which memory pool a block is in.

   unsigned short mPoolIndex;
   // Memory block index, specifies which block within the memory pool.
   unsigned short mBlockIndex;

   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   //---------------------------------------------------------------------------
   // Constructor

   BlockHandle::BlockHandle()
   {
      mPoolIndex = 0;
      mBlockIndex = 0;
   }

   BlockHandle::BlockHandle(unsigned short aPoolIndex, unsigned short aBlockIndex)
   {
      mPoolIndex = aPoolIndex;
      mBlockIndex = aBlockIndex;
   }

   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   //---------------------------------------------------------------------------
   // Set

   void setNull()
   {
      mPoolIndex = 0;
      mBlockIndex = 0;
   }

   // Set
   void set(unsigned short aPoolIndex, unsigned short aBlockIndex)
   {
      mPoolIndex = aPoolIndex;
      mBlockIndex = aBlockIndex;
   }

   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   //---------------------------------------------------------------------------
   // Null

   bool isNull()
   {
      return mPoolIndex==0 || mBlockIndex==0;
   }

   static BlockHandle null()
   {
      BlockHandle tTemp;
      tTemp.setNull();
      return tTemp;
   }

   static BlockHandle nullH;

   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   //--------------------------------------------------------------------------
   // Handle to pointer conversions.

   static void* ptr(BlockHandle aBlockHandle);
};

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Operators

inline bool operator==(const BlockHandle& lhs, const BlockHandle& rhs)
{
   return lhs.mPoolIndex == rhs.mPoolIndex && lhs.mBlockIndex == rhs.mBlockIndex;
}

// Operator
inline bool operator!=(const BlockHandle& lhs, const BlockHandle& rhs)
{
   return lhs.mPoolIndex != rhs.mPoolIndex && lhs.mBlockIndex != rhs.mBlockIndex;
}

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Base class for classes whose storage is managed by memory pools.
// Inheriting classes contain a memory handle.

class HasBlockHandle
{
public:
   BlockHandle mBlockHandle;
};

//******************************************************************************
//******************************************************************************
//******************************************************************************
}//namespace
#endif